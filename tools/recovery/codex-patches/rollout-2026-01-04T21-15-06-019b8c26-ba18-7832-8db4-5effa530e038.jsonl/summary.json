{
  "sessionFile": "rollout-2026-01-04T21-15-06-019b8c26-ba18-7832-8db4-5effa530e038.jsonl",
  "meta": {
    "id": "019b8c26-ba18-7832-8db4-5effa530e038",
    "timestamp": "2026-01-05T03:15:06.904Z",
    "cwd": "c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52",
    "originator": "codex_vscode"
  },
  "applyPatchCount": 4,
  "touchedFiles": [
    "apps/client/src/App.css",
    "tools/recovery/README.md",
    "tools/recovery/extract-codex-patches.mjs"
  ],
  "gitCommands": [
    "@' const fs = require('fs'); const path = require('path'); const all = [ 'C:/Users/cafal/.codex/sessions/2026/01/02/rollout-2026-01-02T10-00-37-019b7f70-7d3f-7642-bc89-9e9db24d4eab.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/02/rollout-2026-01-02T10-20-00-019b7f82-3f29-7081-a16e-302efdaf8d7a.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T20-59-37-019b8c18-8a1f-7f71-aaad-d114a3fe1a04.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-10-13-019b8c22-4115-7f92-b483-20adf29b524a.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-12-59-019b8c24-c8eb-7802-a498-91e051a9203b.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-15-06-019b8c26-ba18-7832-8db4-5effa530e038.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-53-17-019b8c49-ac9d-7d51-a1be-dad5b270416f.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T22-03-58-019b8c53-75f2-74c3-b1c3-2d513298642e.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T22-09-01-019b8c58-1493-7df0-968d-ea1f5f176262.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T22-34-03-019b8c6f-0011-7d92-b457-eb8e495beb63.jsonl', ].filter((p) => fs.existsSync(p)); function uniq(arr) { return Array.from(new Set(arr)); } function extractPatchFiles(patch) { if (typeof patch !== 'string') return []; const out = []; const re = /^\\*\\*\\* (Add File|Update File|Delete File|Move to):\\s+(.+)$/gm; let m; while ((m = re.exec(patch))) out.push(m[2].trim()); return out; } function normalizeCmd(cmd) { return String(cmd || '').replace(/\\s+/g, ' ').trim(); } const summary = []; for (const file of all) { const lines = fs.readFileSync(file, 'utf8').split(/\\r?\\n/).filter(Boolean); let meta = null; const touched = new Set(); const apply = []; const shell = []; for (const line of lines) { let obj; try { obj = JSON.parse(line); } catch { continue; } if (!meta && obj.type === 'session_meta') { meta = { id: obj?.payload?.id, ts: obj?.payload?.timestamp, cwd: obj?.payload?.cwd, originator: obj?.payload?.originator, }; } if (obj.type !== 'response_item') continue; const payload = obj.payload; if (!payload) continue; if (payload.type === 'custom_tool_call' && payload.name === 'apply_patch') { const patch = payload.input; apply.push({ ts: obj.timestamp, bytes: typeof patch === 'string' ? patch.length : 0 }); for (const f of extractPatchFiles(patch)) touched.add(f); } if (payload.type === 'function_call' && payload.name === 'shell_command') { let args = payload.arguments; if (typeof args === 'string') { try { args = JSON.parse(args); } catch { // ignore } } const cmd = normalizeCmd(args?.command); if (cmd) shell.push(cmd); } } const git = uniq(shell.filter((c) => /\\bgit\\b/i.test(c))); const destructive = uniq(git.filter((c) => /git\\s+(restore|checkout|reset|clean)\\b/i.test(c))); summary.push({ file: file.replace(/.*\\//, ''), sessionId: meta?.id, when: meta?.ts, applyPatchCount: apply.length, touchedFiles: Array.from(touched).sort(), destructiveGit: destructive, }); } console.log(JSON.stringify(summary, null, 2)); '@ | node -",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; $i=0; git show HEAD:apps/client/src/App.css | Select-Object -First 80 | ForEach-Object { $ln=++$i; \"${ln}: $_\" }",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; $start=150; $count=120; $i=0; git show HEAD:apps/client/src/App.css | Select-Object -Skip $start -First $count | ForEach-Object { $ln=$start + (++$i); \"${ln}: $_\" }",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; $start=280; $count=30; $i=0; git show HEAD:apps/client/src/App.css | Select-Object -Skip $start -First $count | ForEach-Object { $ln=$start + (++$i); \"${ln}: $_\" }",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; $start=310; $count=35; $i=0; git show HEAD:apps/client/src/App.css | Select-Object -Skip $start -First $count | ForEach-Object { $ln=$start + (++$i); \"${ln}: $_\" }",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; @' const fs = require('fs'); const path = require('path'); const sessionFiles = [ 'C:/Users/cafal/.codex/sessions/2026/01/02/rollout-2026-01-02T10-00-37-019b7f70-7d3f-7642-bc89-9e9db24d4eab.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/02/rollout-2026-01-02T10-20-00-019b7f82-3f29-7081-a16e-302efdaf8d7a.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T20-59-37-019b8c18-8a1f-7f71-aaad-d114a3fe1a04.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-10-13-019b8c22-4115-7f92-b483-20adf29b524a.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-12-59-019b8c24-c8eb-7802-a498-91e051a9203b.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-15-06-019b8c26-ba18-7832-8db4-5effa530e038.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T21-53-17-019b8c49-ac9d-7d51-a1be-dad5b270416f.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T22-03-58-019b8c53-75f2-74c3-b1c3-2d513298642e.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T22-09-01-019b8c58-1493-7df0-968d-ea1f5f176262.jsonl', 'C:/Users/cafal/.codex/sessions/2026/01/04/rollout-2026-01-04T22-34-03-019b8c6f-0011-7d92-b457-eb8e495beb63.jsonl', ].filter((p) => fs.existsSync(p)); function uniq(arr) { return Array.from(new Set(arr)); } function extractPatchFiles(patch) { if (typeof patch !== 'string') return []; const out = []; const re = /^\\*\\*\\* (Add File|Update File|Delete File|Move to):\\s+(.+)$/gm; let m; while ((m = re.exec(patch))) out.push(m[2].trim()); return out; } function normalizeCmd(cmd) { return String(cmd || '').replace(/\\s+/g, ' ').trim(); } const results = []; for (const file of sessionFiles) { const lines = fs.readFileSync(file, 'utf8').split(/\\r?\\n/).filter(Boolean); let meta = null; const touchedFiles = new Set(); const gitCommands = []; const applyPatches = []; for (const line of lines) { let obj; try { obj = JSON.parse(line); } catch { continue; } if (!meta && obj.type === 'session_meta') { meta = { id: obj?.payload?.id, ts: obj?.payload?.timestamp, cwd: obj?.payload?.cwd, originator: obj?.payload?.originator, }; } if (obj.type !== 'response_item') continue; const payload = obj.payload; if (!payload || payload.type !== 'function_call') continue; const name = payload.name; let args = payload.arguments; if (typeof args === 'string') { try { args = JSON.parse(args); } catch { // ignore } } if (name === 'apply_patch') { const patch = args?.patch ?? args; applyPatches.push({ size: typeof patch === 'string' ? patch.length : 0 }); for (const f of extractPatchFiles(patch)) touchedFiles.add(f); } if (name === 'shell_command') { const cmd = normalizeCmd(args?.command); if (!cmd) continue; if (/\\bgit\\b/i.test(cmd)) gitCommands.push(cmd); if (/git\\s+(restore|checkout|reset|clean|stash)/i.test(cmd)) gitCommands.push(cmd); } } results.push({ file: path.basename(file), meta, touchedFiles: Array.from(touchedFiles).sort(), applyPatchCount: applyPatches.length, gitCommands: uniq(gitCommands).slice(0, 30), }); } console.log(JSON.stringify(results, null, 2)); '@ | node -",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git branch --show-current",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git branch -vv",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff -- apps/client/src/App.css",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff --cached --name-only",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff --name-only",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff --stat",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff -U3 -- apps/client/src/features/board/Board.tsx | Select-Object -First 200",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff -U5 -- apps/client/src/features/board/Board.tsx | Select-String -Pattern \"hex-tier|hex-resources|className=\\\"hex\\\"|classes =\" -Context 3,6",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git diff -U5 -- apps/client/src/features/board/Board.tsx | Select-String -SimpleMatch -Pattern \"hex-tier\",\"hex-resources\",\"classes =\" -Context 3,6",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git log --oneline --decorate --graph --all -20",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git log --oneline -10",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git log --since=\"3 days ago\" --oneline --decorate",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git reflog -20 --date=relative",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git restore . ':!apps/client/src/App.css'",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git show HEAD:apps/client/src/App.css | rg -n \"\\.board-canvas\"",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git show HEAD:apps/client/src/features/board/Board.tsx | rg -n \"hex-tier|hex-resources|hex-res\"",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git stash list",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git status --porcelain",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git status --porcelain=v1",
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git status -sb",
    "rg -n \"git restore \\. ':!apps/client/src/App\\.css'\" C:\\Users\\cafal\\.codex\\sessions\\2026\\01\\04\\rollout-2026-01-04T21-15-06-019b8c26-ba18-7832-8db4-5effa530e038.jsonl"
  ],
  "destructiveGitCommands": [
    "cd c:\\Users\\cafal\\OneDrive\\Documents\\GitHub\\stellcon-g52; git restore . ':!apps/client/src/App.css'",
    "rg -n \"git restore \\. ':!apps/client/src/App\\.css'\" C:\\Users\\cafal\\.codex\\sessions\\2026\\01\\04\\rollout-2026-01-04T21-15-06-019b8c26-ba18-7832-8db4-5effa530e038.jsonl"
  ]
}